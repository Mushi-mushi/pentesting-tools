#!/bin/bash

if [ $# -eq 0 ]
  then
    echo "Please provide two arguments, output name and IP"
    exit 1
fi

echo Box name: $1
echo Box IP : $2

masscan -p1-65535 $2 --rate=1000 -e tun0 > ports 
ports=$(cat ports | awk -F " " '{print $4}' | awk -F "/" '{print $1}' | sort -n | tr '\n' ',' | sed 's/,$//')
rm ports
nmap -Pn -sV -sC -p$ports $2 -oA $1
nmap -sU $2 -oA $1.udp 


#quickscan="quickscan.${1}"
#fullscan="fullscan.${1}"
#udpscan="udpscan.${1}"

#echo $quickscan
#echo $fullscan
#echo $udpscan

#nmap -sC -sV -oA $quickscan $2
#nmap -p- -oA $fullscan $2 
#nmap -sU -oA $udpscan $2 
